# 需求文档

## 一、系统概述

本系统是一个电子商务系统，主要面向普通用户和管理员。普通用户可以在前台进行注册登录，管理个人信息、收货地址，还能浏览商品，通过关键词、分类等多种方式搜索筛选商品，查看商品详情、评分及评价。购物车支持商品的添加、修改、删除操作，会显示总价、优惠抵扣和运费，库存不足或下架商品会自动标记。订单管理可查看订单状态，未支付订单能取消（超时自动取消），已完成订单可申请退款、评分和评价，并且能按时间段查看消费记录、导出消费明细。

管理员则在后台进行各项管理工作。用户管理方面，可查看用户列表、管控用户权限、记录用户敏感操作；商品管理上，支持多级分类，能对商品信息进行增删改，还可创建促销活动；订单管理时，能按多种条件筛选订单，处理退换货申请，手动干预订单发货状态；数据统计与分析可获取实时销售数据、分析消费偏好并生成报表；优惠券管理可创建优惠券并精准发放给指定用户。此外，系统高度重视数据安全，对用户密码加密存储，控制订单数据访问权限，定期备份和恢复数据库，旨在为用户提供流畅的购物体验，为管理员提供高效的管理功能 。

## 二、功能需求

### 2.1	前台功能

#### 1. 用户管理

   • **注册与登录**
     ◦ 用户名+密码注册（合法性检查）
     ◦ 用户名+密码登录
   • **个人信息管理**
     ◦ 查看/修改个人信息（姓名、性别、年龄、联系方式、密码）
     ◦ 绑定/解绑邮箱、手机号
   • **地址管理**
     ◦ 添加/编辑/删除收货地址
     ◦ 设置默认地址

#### 2. 商品浏览与购买

   • **商品搜索与筛选**
     ◦ 关键词搜索
     ◦ 按分类、价格区间、销量等筛选
     ◦ 排序功能（价格、销量、上架时间）
   • **商品详情查看**
     ◦ 商品信息展示（图片、描述、价格、库存、运费）
     ◦ 查看评分、评价
     ◦ 按好评/差评筛选评价
   • **购物车管理**
     ◦ 添加/批量修改/删除商品
     ◦ 显示总价、优惠抵扣、运费计算
     ◦ 库存不足或下架商品自动标记
   • **订单管理**
     ◦ 查看订单状态（待支付、已发货、已完成、已退款）  
     ◦ 对已完成订单申请退款
     ◦ 取消未支付订单（超时自动取消）
     ◦ 对已完成订单进行评分和评价

#### 3. 消费统计

   • 按时间段查看消费记录（日/周/月，支持一年内记录）
   • 按商品类别显示消费占比
   • 导出消费明细（Excel/PDF）

### 2.2	后台功能

#### 1. 用户管理

   • **用户列表**
     ◦ 查看用户信息、注册时间、消费总额
   • **权限管控**
     ◦ 分配用户角色（普通用户、VIP用户）
     ◦ 禁用违规账号
   • **操作日志**
     ◦ 记录用户敏感操作（密码修改、删除评价）

#### 2. 商品管理

   • **分类管理**
     ◦ 多级商品分类（如电子产品->手机->苹果手机）
   • **商品管理**
     ◦ 添加/编辑/删除商品信息（名称、价格、简介、库存、运费）
     ◦ 创建满减、优惠券活动并绑定商品

#### 3. 订单管理

   • **订单筛选**
     ◦ 按时间（时间段）、用户ID、订单状态、支付方式筛选
   • **退换货处理**
     ◦ 审核退货申请并确认退款金额
   • **人工干预**
     ◦ 手动标记订单为已发货

#### 4. 数据统计与分析

   • **销售数据**
     ◦ 实时销售额、订单量、热销商品Top10
     ◦ 按地区/用户年龄段分析消费偏好
   • **生成报表**
     ◦ 自动生成日报/周报/月报（PDF/Excel）

#### 5. 优惠券管理

   • 创建优惠券（类型、折扣值、生效时间等）
   • 将优惠券发放到指定用户（用户id、性别、类型、匹配、地区）

#### 6. 数据安全

   • 用户密码加密存储
   • 订单数据权限控制（仅对应用户和管理员可见）
   • 定期数据库备份与恢复

## 三、数据需求

### 3.1 数据实体与字段说明

#### 3.1.1 用户基本信息

* **user_id**（整数）：用户唯一标识（主键）
* **username**（字符串）：用户名（需唯一）
* **password**（字符串）：加密存储的用户密码
* **email**（字符串）：绑定的邮箱（支持解绑）
* **phone**（字符串）：绑定的手机号（支持解绑）
* **gender**（字符串）：性别（男 / 女 / 保密）
* **age**（整数）：年龄
* **is_vip**（布尔）：是否为 VIP 用户（管理员分配）
* **create_time**（时间戳）：注册时间
* **update_time**（时间戳）：信息更新时间

#### 3.1.2 商品分类信息

* **category_id**（整数）：分类唯一标识（主键）
* **name**（字符串）：分类名称
* **parent_id**（整数）：父分类 ID（支持多级分类，顶级分类为 0）
* **create_time**（时间戳）：创建时间

#### 3.1.3 商品基本信息

* **product_id**（整数）：商品唯一标识（主键）
* **name**（字符串）：商品名称
* **description**（字符串）：商品简介
* **price**（浮点数）：单价
* **stock**（整数）：库存数量
* **freight**（浮点数）：运费（功能清单新增字段）
* **category_id**（整数）：所属分类 ID（外键关联商品分类表）
* **create_time**（时间戳）：创建时间
* **update_time**（时间戳）：信息更新时间

#### 3.1.4 地址信息

* **address_id**（整数）：地址唯一标识（主键）
* **user_id**（整数）：用户 ID（外键关联用户表）
* **recipient_name**（字符串）：收货人姓名
* **phone**（字符串）：收货人电话
* **address_line1**（字符串）：详细地址（街道 / 门牌号）
* **city**（字符串）：城市
* **state**（字符串）：省份 / 州
* **postal_code**（字符串）：邮政编码
* **is_default**（布尔）：是否为默认地址
* **create_time**（时间戳）：创建时间

#### 3.1.5 订单信息

* **order_id**（整数）：订单唯一标识（主键）
* **user_id**（整数）：用户 ID（外键关联用户表）
* **total_amount**（浮点数）：订单总金额（含运费）
* **status**（字符串）：订单状态（待支付 / 已支付 / 已发货 / 已完成 / 已退款）
* **payment_method**（字符串）：支付方式（功能清单新增字段）
* **create_time**（时间戳）：创建时间
* **update_time**（时间戳）：状态更新时间

#### 3.1.6 订单明细信息

* **order_detail_id**（整数）：订单明细唯一标识（主键）
* **order_id**（整数）：订单 ID（外键关联订单表）
* **product_id**（整数）：商品 ID（外键关联商品表）
* **quantity**（整数）：购买数量
* **unit_price**（浮点数）：商品单价（下单时快照）
* **create_time**（时间戳）：创建时间

#### 3.1.7 优惠券信息

* **coupon_id**（整数）：优惠券唯一标识（主键）
* **type**（字符串）：类型（满减 / 折扣 / 固定金额）
* **discount_value**（浮点数）：折扣值（满减金额 / 折扣比例）
* **min_order_amount**（浮点数）：最低使用金额
* **start_time**（时间戳）：生效时间
* **end_time**（时间戳）：失效时间
* **status**（字符串）：状态（未使用 / 已使用 / 已过期）
* **create_time**（时间戳）：创建时间
* **update_time**（时间戳）：信息更新时间

#### 3.1.8 优惠券发放记录

* **distribution_id**（整数）：发放记录唯一标识（主键）
* **coupon_id**（整数）：优惠券 ID（外键关联优惠券表）
* **user_id**（整数）：用户 ID（外键关联用户表）
* **gender_filter**（字符串）：性别筛选条件（功能清单发放条件字段）
* **region_filter**（字符串）：地区筛选条件（功能清单发放条件字段）
* **create_time**（时间戳）：发放时间

#### 3.1.9 商品评价信息

* **review_id**（整数）：评价唯一标识（主键）
* **product_id**（整数）：商品 ID（外键关联商品表）
* **user_id**（整数）：用户 ID（外键关联用户表）
* **order_id**（整数）：订单 ID（外键关联订单表，确保已购买）
* **rating**（整数）：评分（1-5 星）
* **content**（字符串）：评价内容
* **create_time**（时间戳）：创建时间

#### 3.1.10 操作日志信息

* **log_id**（整数）：日志唯一标识（主键）
* **user_id**（整数）：用户 ID（外键关联用户表）
* **action**（字符串）：操作类型（密码修改 / 删除评价）
* **create_time**（时间戳）：操作时间

### 3.2 数据关系说明

1. 用户 - 地址关系：一个用户可拥有多个地址，通过`user_id`​关联
2. 用户 - 订单关系：一个用户可生成多个订单，通过`user_id`​关联
3. 订单 - 商品关系：一个订单包含多个商品，通过`order_id`​关联
4. 商品 - 分类关系：一个商品属于一个分类，通过`category_id`​关联
5. 优惠券 - 发放记录关系：一张优惠券可发放给多个用户，通过`coupon_id`​关联
6. 评价 - 订单关系：一条评价对应一个订单，通过`order_id`​关联

### 3.3 数据安全需求

1. 密码加密：用户密码采用 SHA-256 哈希算法加密存储
2. 权限控制：

    * 订单数据仅允许用户本人和管理员访问
    * 敏感操作（如修改密码）需二次验证
3. 数据备份：每日自动备份数据库，保留最近 7 天的备份记录

## 四、技术栈选型

### 4.1 前端技术

* **框架**：Vue 3 + TypeScript
* **UI 库**：Element-UI（PC 端）
* **路由管理**：Vue Router 4
* **状态管理**：Pinia
* **图表库**：ECharts（消费统计可视化）
* **CSS 预处理**：SCSS
* **构建工具**：Vite

### 4.2 后端技术

* **语言**：Java 17
* **框架**：Spring Boot 3.2.0
* **ORM**：Spring Data JPA + Hibernate
* **认证**：Spring Security + JWT
* **消息队列**：ActiveMQ
* **搜索服务**：MySQL 检索

### 4.3 数据库

* **主数据库**：MySQL
* **缓存层**：Redis
* **文件存储**：本地文件系统（用户头像 / 商品图片）

### 4.4 中间件

* **CORS**：Spring Boot 原生支持
* **安全**：Spring Security 默认配置
* **日志**：Logback + SLF4J
* **监控**：Actuator（本地服务健康检查）

### 4.5 部署方式

* **后端**：Spring Boot 内置 Tomcat 直接运行
* **前端**：Vite 构建后静态文件部署
* **数据库**：本地 MySQL 服务
